Τι είναι το CNN embedding

CNN = Convolutional Neural Network (Συνελικτικό Νευρωνικό Δίκτυο)

Ένα CNN είναι ένας τύπος νευρωνικού δικτύου ειδικά σχεδιασμένος για εικόνες.

Παίρνει μια εικόνα ως είσοδο και περνάει από διάφορα layers που αναγνωρίζουν χαρακτηριστικά (π.χ. άκρα, καμπύλες, patterns).

Embedding:

Με απλά λόγια, ένα embedding είναι ένα vector αριθμών που περιγράφει τα σημαντικά χαρακτηριστικά μιας εικόνας.

Στην περίπτωσή μας: κάθε fingerprint γίνεται ένα vector 512 διαστάσεων (ResNet18).

Το embedding ΔΕΝ είναι η αρχική εικόνα, αλλά μια αριθμητική αναπαράσταση της εικόνας, έτοιμη για ανάλυση με ML ή TDA.

Γιατί χρησιμοποιούμε embeddings αντί για raw εικόνες:

Είναι πιο συμπυκνωμένα (512 αριθμοί αντί για 224x224 pixels).

Περιέχουν τα πιο σημαντικά χαρακτηριστικά για αναγνώριση ή σύγκριση.

Μπορούμε να κάνουμε UMAP, Mapper, clustering ή k-NN πολύ πιο αποτελεσματικά.

2️⃣ Γιατί χρησιμοποιήσαμε PyTorch + Torchvision
a) PyTorch

Είναι ένα framework για deep learning.

Μας επιτρέπει να δουλεύουμε εύκολα με tensors (πολύ-διαστατικά arrays).

Παρέχει αυτόματο υπολογισμό gradients για εκπαίδευση νευρωνικών δικτύων.

Στην περίπτωση μας δεν εκπαιδεύουμε νέο μοντέλο, αλλά χρησιμοποιούμε ένα προ-εκπαιδευμένο μοντέλο (pretrained) για να πάρουμε embeddings.

b) Torchvision

Παρέχει έτοιμα CNN μοντέλα όπως ResNet, VGG, EfficientNet.

Παρέχει επίσης έτοιμες μετασχηματίσεις εικόνων (resize, normalization, conversion to tensor).

Χρησιμοποιούμε το models.resnet18(pretrained=True) για να πάρουμε embeddings απευθείας, χωρίς να εκπαιδεύσουμε CNN από την αρχή.

3️⃣ Πώς λειτουργεί πρακτικά

Διαβάζουμε μια εικόνα fingerprint.

Μετατρέπουμε σε RGB + Tensor + κανονικοποίηση (για να ταιριάζει με το pretrained CNN).

Την περνάμε στο CNN χωρίς το τελικό classification layer → παίρνουμε ένα 512-D vector.

Αυτό το vector X.npy θα χρησιμοποιηθεί σε όλα τα επόμενα βήματα: UMAP, Mapper, Persistent Homology, k-NN.

Σκέψου το CNN σαν ένα “feature extractor”: παίρνει εικόνα και βγάζει αριθμούς που λένε “αυτό το fingerprint έχει αυτά τα patterns”.

Αν θέλεις, μπορώ να σου φτιάξω ένα μικρό σχήμα που δείχνει την εικόνα να μπαίνει στο CNN και να βγαίνει το embedding vector, για να το βλέπεις οπτικά.



---------------------------------------------------------------
🔹 STEP 4 — Μείωση διαστάσεων με UMAP

Μέχρι τώρα έχεις κάνει κάτι πολύ σημαντικό:

Μετέτρεψες εικόνες δακτυλικών αποτυπωμάτων → 512-διάστατα vectors (embeddings)

Όμως:

512 διαστάσεις δεν μπορούμε να τις δούμε

ούτε να τις “καταλάβουμε” γεωμετρικά

ούτε να εφαρμόσουμε εύκολα Mapper

Εδώ μπαίνει το UMAP.

1️⃣ Τι πρόβλημα λύνει το UMAP

Έχεις:

X ∈ R^(N × 512)


Θέλεις:

Y ∈ R^(N × 2)  ή  R^(N × 3)


✔️ χωρίς να χαθεί η γεωμετρική / τοπολογική δομή
✔️ ώστε fingerprints του ίδιου ατόμου να μένουν κοντά
✔️ και διαφορετικών ατόμων να απομακρύνονται

2️⃣ Τι είναι το UMAP (διαισθητικά)

UMAP = Uniform Manifold Approximation and Projection

Σκέψου το έτσι:

Τα embeddings σου ζουν σε έναν “καμπύλο χώρο” (manifold) μέσα στις 512 διαστάσεις.
Το UMAP προσπαθεί να ξεδιπλώσει αυτό το manifold σε 2D, κρατώντας τις γειτονιές.

Πρακτικά:

Φτιάχνει ένα γράφημα γειτόνων (k-NN graph)

Υπολογίζει πιθανότητες σύνδεσης

Προβάλλει τα σημεία σε χαμηλές διαστάσεις

Διατηρεί:

τοπικές σχέσεις

και αρκετή global δομή

👉 Αυτό είναι ιδανικό για TDA & Mapper

3️⃣ Γιατί UMAP και όχι PCA ή t-SNE
Μέθοδος	Πρόβλημα
PCA	Γραμμική, χάνει μη-γραμμική δομή
t-SNE	Καλό visualization, κακό για Mapper
UMAP	✔️ topology-friendly, ✔️ σταθερό, ✔️ γρήγορο

👉 Στη βιβλιογραφία TDA, UMAP + Mapper είναι standard επιλογή.

4️⃣ Τι θα κάνουμε πρακτικά στο Step 4

Θα γράψουμε ένα script π.χ.:

src/
 └── s4_umap.py


Αυτό το script θα:

Φορτώσει:

X.npy

meta.csv

Τρέξει UMAP

Αποθηκεύσει:

X_umap.npy

ένα scatter plot (png)



ι αρχεία παράγονται & τι σημαίνουν
🔹 X_umap.npy

Σχήμα: (N, 2)

Κάθε fingerprint → σημείο στο επίπεδο

Αυτό είναι το input για Mapper

🔹 umap.png

Οπτικοποίηση των fingerprints

Αν δεις:

καθαρά clusters → καλά embeddings

έντονη ανάμιξη → δύσκολο identification

👉 Αυτό είναι ήδη επιστημονικό αποτέλεσμα

7️⃣ Πώς συνδέεται με ασφάλεια συστημάτων

Στο context της διπλωματικής:

Αν fingerprints ίδιου ατόμου:

σχηματίζουν συμπαγείς περιοχές → ✔️ robust system

Αν διαφορετικά άτομα:

μπλέκονται → ❌ πιθανό false accept

Το UMAP σου δίνει γεωμετρική απόδειξη της ποιότητας του embedding.


-----------------------------------------------------------------------------------



🧩 Τι έκανες ουσιαστικά (σε 3 bullets για διπλωματική)

Χρησιμοποίησες pretrained CNN (ResNet18) ως feature extractor

Μετέτρεψες fingerprints σε διανύσματα χαρακτηριστικών

Δημιούργησες feature space κατάλληλο για TDA	



---------------------------------------------------------------------------------
🔹 ΒΗΜΑ 4 — UMAP (Dimensionality Reduction)
🎯 Στόχος του βήματος

Έχουμε:

X ∈ R^{80×512} (CNN embeddings)

Θέλουμε:

X_umap ∈ R^{80×2}

ώστε:

να οπτικοποιήσουμε τα fingerprints

να το χρησιμοποιήσουμε ως lens για Mapper (TDA)

🧠 Τι είναι το UMAP (με απλά λόγια)

Το UMAP:

κρατά γειτονιές (ποια fingerprints μοιάζουν)

«διπλώνει» τον 512-D χώρο σε 2-D

διατηρεί τοπική δομή (κρίσιμο για TDA)

👉 Δεν μας νοιάζει η ακρίβεια ανά σημείο
👉 Μας νοιάζει η γεωμετρία του χώρου

----------------------------------------------------------------------------------
🔐 Τι σημαίνει node purity (ΑΣΦΑΛΕΙΑ)

Purity = 1.0
→ όλα τα fingerprints στον κόμβο ανήκουν στο ίδιο άτομο
✔️ ασφαλής περιοχή

Purity < 1.0
→ fingerprints από διαφορετικά άτομα στο ίδιο topological region
⚠️ πιθανό confusion / spoof risk

👉 Αυτό είναι ακριβώς το security angle της διπλωματικής σου.